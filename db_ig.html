<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Air–Drop</title>
  <style>
    @font-face {
      font-family: 'NeueHaasGroteskDisplayPro-Black';
      src: url('https://pancake.garden/0_font/NeueHaasGroteskDisplayPro-Black-tabular.woff') format('woff');
      src: url('https://pancake.garden/0_font/NeueHaasGroteskDisplayPro-Black-tabular.woff2') format('woff2');
    }
    body {
      background: white;
      /* background-color: rgb(236, 235, 121); */
      font-family: 'NeueHaasGroteskDisplayPro-Black';
      /* cursor: none; */
      overflow: hidden;
    }

    ::-webkit-scrollbar { 
      width: 0;
    }

    p {
      display: none;
      margin-block-start: 0;
      margin-block-end: 0;
    }

    .entry {
      margin-bottom: 50px;
      padding: 10px;
    }
    
    .timestamp {
      text-decoration: line-through;
    }

    svg {
      max-width: 100%;
    }

    .floating {
        animation: floaty 2s ease-in-out infinite;
    }

    @keyframes floaty {
      0%   { transform: translateY(0px); }
      50%  { transform: translateY(-8px); }
      100% { transform: translateY(0px); }
    }

    .longitude {
      position: fixed;
      left: 50%;
      width: 350px;

      font-family: 'NeueHaasGroteskDisplayPro-Black';
      font-size: 80px;
      text-align: right;
      z-index: 5;
      pointer-events: none;
    }

    .long-T {
      top: -15px;
      -webkit-transform: translate(-50%, 0);
      -moz-transform: translate(-50%, 0);
      -ms-transform: translate(-50%, 0);
      -o-transform: translate(-50%, 0);
      transform: translate(-50%, 0);
    }

    .long-B {
      bottom: -15px;
      -webkit-transform: translate(-50%, 0) scale(-1);
      -moz-transform: translate(-50%, 0) scale(-1);
      -ms-transform: translate(-50%, 0) scale(-1);
      -o-transform: translate(-50%, 0) scale(-1);
      transform: translate(-50%, 0) scale(-1);
    }

    /* ---------------------------------------- */
    .latitude {
      position: fixed;
      top: 50%;
      height: 300px;

      font-family: 'NeueHaasGroteskDisplayPro-Black';
      font-size: 80px;
      text-align: right;
      z-index: 5;
      pointer-events: none;
    }

    .lat-L {
      left: -15px;
      writing-mode: vertical-rl;
      -webkit-transform: translate(0, calc(-50% - 30px)) scale(-1);
      -moz-transform: translate(0, calc(-50% - 30px)) scale(-1);
      -ms-transform: translate(0, calc(-50% - 30px)) scale(-1);
      -o-transform: translate(0, calc(-50% - 30px)) scale(-1);
      translate: translate(0, calc(-50% - 30px)) scale(-1);
    }

    .lat-R {
      right: -15px;
      writing-mode: vertical-rl;
      -webkit-transform: translate(0, calc(-50% - 30px));
      -moz-transform: translate(0, calc(-50% - 30px));
      -ms-transform: translate(0, calc(-50% - 30px));
      -o-transform: translate(0, calc(-50% - 30px));
      transform: translate(0, calc(-50% - 30px));
    }

    #content {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      /* padding: 100px 0 0 0; */
      
      display: flex;
      flex-direction: column;
      align-items: center;
      
      font-family: 'NeueHaasGroteskDisplayPro-Black';
      font-size: 34px;
      text-align: center;
      
      overflow-x: hidden;
      overflow-y: auto;
      z-index: 2;

      cursor: grab;
      /* backdrop-filter: blur(9px); */
    }

    #drawingArea {
      backdrop-filter: none !important;
    }

    .postArea {
      position: fixed; 
      top: 50%; 
      left: 50%; 
      -webkit-transform: translate(-50%, -50%);
      -moz-transform: translate(-50%, -50%);
      -ms-transform: translate(-50%, -50%);
      -o-transform: translate(-50%, -50%);
      transform: translate(-50%, -50%);
      height: 100%; 
      aspect-ratio: 1080 / 1350;
      font-size: 0;
      background-color: rgb(236, 235, 121);
      /* background-color: hsl(50, 75%, 70%); */
    }
  </style>
</head>
<body>

  <!-- <div class="longitude long-T">120°05 </div>
  <div class="latitude lat-R">30°16</div>
  <div class="longitude long-B"> 120°05</div>
  <div class="latitude lat-L">30°16</div> -->
  
  <div id="content"></div>

  <div class="postArea">
    <!-- <video src="img/IMG_3482.MOV" style="width: 100%; margin: 0; padding: 0;" autoplay> -->
    <img src="img/Mouse_1_3024,3780.png" style="width: 100%; margin: 0; padding: 0;">
  </div>

  <script>
    fetch('data/db_ig.json')
      .then(response => response.json())
      .then(data => {
        const content = document.getElementById('content');
        const entries = Array.isArray(data) ? data : [data];
        const seenSVGs = new Set();
  
        entries.forEach(entry => {
          if (seenSVGs.has(entry.svg)) return;
          seenSVGs.add(entry.svg);
  
          const container = document.createElement('div');
          container.className = 'entry';
          container.style.position = 'absolute'; // 개별 위치 가능하게
          container.style.left = '0';
          container.style.top = '50%';
          container.style.transform = 'translate(-50%, -50%) scale(1)';
          container.style.transformOrigin = 'center center';
          container.dataset.scale = 1;
          container.dataset.x = 0;
          container.dataset.y = 0;
  
          const svgWrapper = document.createElement('div');
          svgWrapper.innerHTML = entry.svg;
          container.appendChild(svgWrapper);
  
          const gElements = svgWrapper.querySelectorAll('g');
          gElements.forEach((g, index) => {
            g.classList.add('floating');
            g.style.animationDelay = `${index * 0.1}s`;
          });
  
          const timestampP = document.createElement('p');
          timestampP.textContent = `${entry.timestamp.date}  ${entry.timestamp.time}`;
          timestampP.classList.add('timestamp');
          container.appendChild(timestampP);
  
          const locationP = document.createElement('p');
          locationP.textContent = `${entry.location.longitude}° ${entry.location.latitude}°  `;
          container.appendChild(locationP);
  
          content.appendChild(container);
  
          // 드래그 기능
          makeDraggable(container);
  
          // 개별 스케일 기능
          enableScrollScale(container);
        });
      })
      .catch(error => {
        console.error('Error loading JSON:', error);
      });
  
    function makeDraggable(el) {
      let isDragging = false;
      let startX, startY, origX, origY;
  
      el.addEventListener('mousedown', (e) => {
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        origX = parseFloat(el.dataset.x);
        origY = parseFloat(el.dataset.y);
        el.style.cursor = 'grabbing';
        e.preventDefault();
      });
  
      window.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;
        const x = origX + dx;
        const y = origY + dy;
        el.dataset.x = x;
        el.dataset.y = y;
        updateTransform(el);
      });
  
      window.addEventListener('mouseup', () => {
        isDragging = false;
        el.style.cursor = 'grab';
      });
    }
  
    function enableScrollScale(el) {
      el.addEventListener('wheel', (e) => {
        e.preventDefault();
        let scale = parseFloat(el.dataset.scale);
        const delta = -e.deltaY || e.wheelDelta;
        scale += (delta > 0 ? 0.05 : -0.05);
        scale = Math.max(0.1, Math.min(5, scale));
        el.dataset.scale = scale;
        updateTransform(el);
      });
    }
  
    function updateTransform(el) {
      const x = parseFloat(el.dataset.x) || 0;
      const y = parseFloat(el.dataset.y) || 0;
      const scale = parseFloat(el.dataset.scale) || 1;
      el.style.transform = `translate(${x}px, ${y}px) scale(${scale})`;
    }
  </script>

</body>
</html>
